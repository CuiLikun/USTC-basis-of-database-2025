# 数据库基础实验（2-4）实验报告

PB23071377 崔立坤

## 实验二 查询 (2 课时）

### 1.无条件查询

1.  查找 authors 表的全部信息。 

   ```sql
   SELECT * FROM authors
   ```

2.  查找其他样例表中全部信息:sales,titles,employee,publishers。

   ```sql
   SELECT * FROM sales
   ```

   ```sql
   SELECT * FROM titles
   ```

   ```sql
   SELECT * FROM employee
   ```

   ```sql
   SELECT * FROM publishers
   ```

   

### 2.简单条件查询

1. 查找 titles 表中全部书号及书名。 

   ```sql
   SELECT title,title FROM titles
   ```

   

2. 查找 titles 表中价格在 $10～15 元之间的书的书名。

   ```sql
   SELECT title FROM titles
   where price BETWEEN 10 AND 15
   ```

   

3. 查找 titles 表中书名以 T 开头的书号, 书名。

   ```sql
   SELECT title,title_id from titles
   where title LIKE 'T%'
   ```

   

4. 对 authors 样例表构造一个简单查询条件，进行查询。

   例如：查找authors表中城市在Oakland的作者的全名（inname+fname)

   ```sql
   SELECT au_lname,au_fname from authors  
   where city = 'Oakland'
   ```

### 3.多条件查询

1. 查找书名起始字符为 T，价格小于 $16 元的书名及价格。

   ```sql
   SELECT title,price from titles   
   where price<16 And title LIKE 'T%'
   ```

   

2. 查找书名起始字符不为 T 的, 价格大于 $16 元的书号, 书名及价格。

   ```sql
   SELECT title,price from titles   
   where price>16 And title not LIKE  'T%'
   ```

   

3. 列出已出售书的书号和数量。 

   ```sql
   SELECT title_id,ytd_sales from titles   
   where ytd_sales is not null
   ```

   

4. 对 publishers 样例表构造一个多条件查询，进行查询。

​        例如：查找出版号大于等于9000，国家为美国的出版商名字

```sql
SELECT pub_name from publishers
where pub_id>=9000 and country ='USA'
```



### 4．使用函数进行查找

使用 titles 表进行查询 

1. 列出有多少种类型的书。

   ```sql
   SELECT COUNT(DISTINCT type) as type_count from titles
   ```

   

2. 列出书的定价有多少种。 

   ```sql
   SELECT COUNT(DISTINCT price) as price_count from titles
   ```

   

3. 查出书价最高的书价。 

   ```sql
   SELECT MAX( price) as MAX_price from titles
   ```

   

4. 列出当年销量的总和。 

   ```sql
   SELECT SUM( ytd_sales) as sum_sales from titles
   ```

   

5. 计算这些书籍的最高书价、最低书价及平均书价。

   最高书价：

   ```sql
   SELECT MAX( price) as MAX_price from titles
   ```

   最低书价：

   ```sql
   SELECT MIN( price) as min_price from titles
   ```

   平均书价：

   ```sql
   SELECT AVG( price) as avg_price from titles
   ```

   

6. 按出版社号分组，列出各个出版社当年销量(ytd_sales)的总合。

    

   ```sql
   SELECT pub_id,SUM(ytd_sales) as everypub_sum_sales  from titles    
   GROUP BY pub_id
   ```

   

7. 计算不同的书名共有多少种；

   ```sql
   SELECT COUNT(DISTINCT title) as book_count from titles
   ```

   

8. 对样例表 sales 构造一个统计查询，给出查询结果。

   例如：列出stor_id有多少种。
   
   ```sql
   SELECT COUNT(DISTINCT stor_id) as stor_id_count from sales
   ```

### 5．得到排序的查询结果 

1. 查找作者的姓、名、电话号码，并按作者姓、名排列。 

   ```sql
   SELECT au_id,au_lname,au_fname  from authors 
   ORDER BY au_lname,au_fname
   ```

   

2. 查找书名和书的价格，按书价由大到小的次序排列。

   ```sql
   SELECT title,price from titles
   where price is not NULL
   ORDER BY price DESC
   ```

   

3. 列出烹调书（类别名含有 cook）的种类和该类的平均价格。

   ```sql
   SELECT type,AVG(price) from titles
   where type LIKE '%cook%'
   GROUP BY type
   ```

   

4. 对其他样例表构造查询条件、排序要求，给出查询结果。

​        例如：列出出版社的国家为美国的出版社名字，并按照名字进行排列(升序)

```sql
SELECT pub_name from publishers
where country='USA'
ORDER BY pub_name
```

​         

### 6.用嵌套或连接进行查询 

1. 使用样例表 titles, publishers 进行查询: 查找出版社的名称以及 所出的书名。

   ```sql
   SELECT title,pub_name from titles,publishers 
   where titles.pub_id=publishers.pub_id
   ```

   

2. 使用样例表 authors, titleauthor, titles 进行查询: 查找作者的 姓、名和所写的书名。 

   ```sql
   SELECT au_lname,au_fname,title from public.titleauthor
   JOIN authors  ON public.titleauthor.au_id=public.authors.au_id
   JOIN public.titles ON public.titleauthor.title_id=public.titles.title_id
   ```

   

3. 从 titles,sales 中找出定单量(qty)最大的那一行定单的书的书名、 价格、定单量。 

4. 构造其他条件，在 sales 和 stores 样例表中进行连接或嵌套查询。
